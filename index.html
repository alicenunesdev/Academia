<!DOCTYPE html>
<html lang="pt-br" >
<head>
  <meta charset="UTF-8" />
  <title>Cadastro de Treinos</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f7f9fc;
      margin: 0;
      padding: 30px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    h1 {
      text-align: center;
      color: #34495e;
    }
    label {
      font-weight: 600;
      display: block;
      margin-top: 20px;
      margin-bottom: 6px;
      color: #2c3e50;
    }
    select, input, button {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      margin-top: 30px;
      background-color: #2980b9;
      color: white;
      font-weight: 700;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #1c5980;
    }
    .grupo-item {
      border: 1px solid #2980b9;
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      position: relative;
      background: white;
    }
    .grupo-item button.remover {
      position: absolute;
      right: 10px;
      top: 10px;
      background: #e74c3c;
      border: none;
      color: white;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      font-weight: 700;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Cadastro de Treinos</h1>

  <label for="usuario">Usuário</label>
  <input type="text" id="usuario" placeholder="Digite o nome do usuário" />

  <label for="tipoTreino">Tipo de Treino</label>
  <select id="tipoTreino">
    <option value="">Selecione</option>
    <option value="Peito">Peito</option>
    <option value="Costas">Costas</option>
    <option value="Pernas">Pernas</option>
    <option value="Braços">Braços</option>
    <option value="Inferior">Inferior</option>
  </select>

  <div id="gruposContainer"></div>

  <button id="addGrupoBtn">Adicionar Grupo</button>

  <button id="salvarBtn">Salvar Treino</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAQZrwPVmbcNZTEcGdqqE-Hscn2TS-hnwY",
    authDomain: "academia-bd-9d4da.firebaseapp.com",
    projectId: "academia-bd-9d4da",
    storageBucket: "academia-bd-9d4da.appspot.com",
    messagingSenderId: "201289997890",
    appId: "1:201289997890:web:19bece6aa0b3d52e3417db",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const gruposContainer = document.getElementById("gruposContainer");
  const addGrupoBtn = document.getElementById("addGrupoBtn");
  const salvarBtn = document.getElementById("salvarBtn");

  addGrupoBtn.addEventListener("click", () => {
    const grupoDiv = document.createElement("div");
    grupoDiv.classList.add("grupo-item");
    grupoDiv.innerHTML = `
      <button class="remover" title="Remover grupo">&times;</button>
      <label>Nome do Grupo</label>
      <input type="text" class="nomeGrupo" placeholder="Ex: Peito" />
      <label>Quantidade de séries</label>
      <input type="number" class="qtdSeries" min="1" value="3" />
    `;
    gruposContainer.appendChild(grupoDiv);

    grupoDiv.querySelector("button.remover").onclick = () => {
      gruposContainer.removeChild(grupoDiv);
    };
  });

  salvarBtn.addEventListener("click", async () => {
    const usuario = document.getElementById("usuario").value.trim();
    const tipoTreino = document.getElementById("tipoTreino").value;

    if (!usuario) {
      alert("Informe o nome do usuário");
      return;
    }
    if (!tipoTreino) {
      alert("Selecione o tipo de treino");
      return;
    }
    const grupos = [];
    const gruposDivs = gruposContainer.querySelectorAll(".grupo-item");

    if (gruposDivs.length === 0) {
      alert("Adicione pelo menos um grupo");
      return;
    }

    for (const gDiv of gruposDivs) {
      const nome = gDiv.querySelector(".nomeGrupo").value.trim();
      const serie = parseInt(gDiv.querySelector(".qtdSeries").value);

      if (!nome || serie < 1) {
        alert("Preencha nome e série corretamente nos grupos");
        return;
      }
      grupos.push({ grupo: nome, serie });
    }

    try {
      await addDoc(collection(db, "academia"), {
        usuario,
        tipoTreino,
        grupos,
        criadoEm: new Date()
      });
      alert("Treino salvo com sucesso!");
      // limpa form
      document.getElementById("usuario").value = "";
      document.getElementById("tipoTreino").value = "";
      gruposContainer.innerHTML = "";
    } catch (e) {
      alert("Erro ao salvar treino: " + e.message);
    }
  });
</script>
</body>
</html>
